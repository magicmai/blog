# 重点：查找 bug 的根源并修复。

## 调试规则
- 规则1：理解系统
- 规则2：制造失败
- 规则3：不要想，而要看
- 规则4：分而治之
- 规则5：一次只改一个地方
- 规则6：保持审计跟踪
- 规则7：检查插头
- 规则8：获得全新观点
- 规则9：如果你不修复 bug，它将依然存在

## 规则1：理解系统
这是第一条规则，因为它是最重要的。
- **阅读手册。** 
- **仔细阅读每个细节。**
- **掌握基础知识。**
- **了解工作流程。**
- **了解工具。**
- **查阅细节。**

## 规则2：制造失败
虽然看起来很简单，但如果不制造失败的话，调试就会变得很困难。
- **制造失败。** 目的是为了观察它，找到原因，并检查是否已修复。
- **从头开始。**
- **引发失败。**
- **但不要模拟失败。**
- **查找不受你控制的条件（正是它导致了间歇性失败）。**
- **记录每件事情，并找到间歇性 bug 的特征。**
- **不要过于相信统计数据。**
- **要认识到“那”是可能会发生的。**
- 永远不要丢掉一个调试工具。**

## 规则3：不要想，而要看
凭空想象，问题可能有几千条原因。而实际的原因只有去看了才能发现。
- **观察失败。** 高级工程师看到了真实的问题，并且能够找到原因。而初级工程师们认为他们知道错误发生在哪里，结果他们修复的地方根本没有出错。
- **查看细节。** 听到水泵似乎发出声音时不要停下来。到地下室查明是哪个水泵。
- **植入插装工具。** 使用源代码调试器、调试日志、状态消息、信号灯和臭鸡蛋的气味。
- **添加外部插装工具。** 使用分析器、示波器、量表、金属检测仪、心电图仪和肥皂泡。
- **不要害怕深入研究。** 虽然它是软件成品，但它出问题了，你必须打开并修复它。
- **注意海森堡效应。** 不要让仪器影响了系统。（[海森堡效应：不确定性原理](https://baike.baidu.com/item/%E4%B8%8D%E7%A1%AE%E5%AE%9A%E6%80%A7%E5%8E%9F%E7%90%86/473553?fr=aladdin)）
- **猜测只是为了确定搜索的重点。**

## 规则4：分而治之
当 bug 的藏身之地不断被缩小一半时，它将很难再隐藏下去。
- **通过逐次逼近缩小搜索范围。** 猜测 1~100 内的一个数字，只需 7 次。
- **确定范围。** 如果数字是 135 而你却认为它在 1~100 内，那么你必须扩大范围。
- **确定你位于 bug 的哪一侧。** 如果你所在的位置有排放物，则排放管就在上游。如果没有排放物，则排放管就在下游。
- **使用易于查看的测试模式。** 从干净、清澈的书开始，以便当排放物进入河流中时很容易看到它。
- **从有问题的一端开始搜索。** 如果你验证的是正确的部分，那么需要验证的地方太多了。应该从有问题的地方开始，然后向后追查原因。
- **修复已知 bug。bug 互相保护，互相隐藏。** 因此一旦找到，立即修复它们。
- **首先消除噪声干扰。** 注意那些导致系统问题的干扰因素。但对一些无足轻重的问题不要过于极端，也不要为了追求完美而去修改所有地方。

## 规则5：一次只改一个地方
我们在生活中要有一点先见之明。如果你所做的更改没有起到预期的作用，那么就把它改回来。它们可能会产生无法预料的影响。
- **隔离关键因素。** 
- **用双手抓住黄铜杆。**
- **一次只改一个测试。**
- **与正常情况进行比较。** 如果所有出错的情况都有一些特征，而这些特征是正常情况所没有的，嘛呢你就找到了问题所在。
- **确定自从上一次正常工作以来你改变了什么地方。**

## 规则6：保持审计跟踪
不要只是在心里记住“保持审计跟踪”这条规则，而要把它写下来。
- **把你的操作、操作的顺序和结果全部记录下来。** 你上一次喝咖啡是什么时候？你的头痛是从什么时候开始的？
- **要知道，任何细节都可能是重要的。**
- **把事件关联到一起。**
- **用于设计的审计跟踪在测试中也非常有用。** 软件配置控制工具可以告诉你哪次修订引入了 bug。
- **把事情记录下来！** 无论哪个时刻多么恐怖，都要把它记到备忘录中，这样你才不会忘记。

## 规则7：检查插头
一些显而易见的假设往往是错误的。请恕我赘述，假设错误通常是最容易修复的错误。
- **置疑你的假设。** 是否运行了正确的代码？是不是燃气用完了？插头是否已插好？
- **从头开始。** 是否正确地对内存进行了 初始化？是否按了除草机上的“primer bulb”按钮？开关是否已打开？
- **对工具进行测试。**

## 规则8：获得全新观点
不管怎样，你都需要休息一下，喝杯咖啡。
- **征求别人的意见。**
- **获取专业知识。**
- **听取别人的经验。**
- **帮助无处不在。** 同事、供应商、网络，还有书店，都在等待着为你提供帮助。
- **放下面子。** bug 发生了。以除掉 bug 为自豪，而不要非得以自己除掉 bug 才为自豪。
- **报告症状，而不要讲你的理论。** 不要把别人拖进你的思维定式中。
- **你提出的问题不必十分肯定。**

## 规则9：如果你不修复 bug，它将依然存在
现在你已经掌握了所有的技术，没有理由再让 bug 存在了。
- **查证问题确实已被修复。**
- **查证确实是你的修复措施解决了问题。**
- **要知道，bug 从来不会自己消失。**
- **从根本上解决问题。**
- **对过程进行修复。**

